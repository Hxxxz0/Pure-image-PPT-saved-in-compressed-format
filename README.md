# PPT图片压缩工具

## 项目简介

这是一个专门为比赛（如大学生创新创业大赛）和学术工作设计的PPT制作工具。在许多比赛和学术场合中，经常需要提交纯图片格式的PPT，但手动一张一张保存图片既费时又难以控制文件大小在20MB以内。本工具可以自动将WPS导出的PNG图片批量转换为PPT格式，并提供压缩功能确保文件大小符合要求。

## 功能特点

- 🚀 **批量处理**：自动处理多张图片，无需手动逐张操作
- 📏 **智能适配**：自动检测图片比例，设置合适的幻灯片尺寸
- 🗜️ **智能压缩**：使用先进压缩算法，自动调整质量确保PPT文件小于20MB
- 📋 **自动排序**：根据文件名中的数字自动排序，保持正确顺序
- 🎯 **两种模式**：支持压缩版本和原始版本，满足不同需求
- 🔧 **二分查找优化**：智能寻找最佳压缩质量，平衡文件大小和图像质量

## 使用场景

- 大学生创新创业大赛PPT制作
- 学术会议演示文稿
- 课程作业和项目汇报
- 任何需要纯图片PPT且有文件大小限制的场合

## 安装依赖

```bash
pip install python-pptx pillow pillow-heif
```

## 使用方法

### 第一步：准备图片文件

1. 在WPS中制作好您的PPT
2. 将PPT导出为PNG图片格式
3. 确保图片文件命名遵循以下规则：
   - **原始图片命名格式**：`副本副本灵枢智镜省赛最终_数字.png`
   - 例如：`副本副本灵枢智镜省赛最终_1.png`、`副本副本灵枢智镜省赛最终_2.png`...
   - **注意**：数字部分决定了幻灯片的顺序，请确保数字连续

### 第二步：压缩图片（重要！）

```bash
python compress_images.py
```

这个步骤会：
- 自动寻找所有符合命名规则的PNG文件
- 使用智能压缩算法将图片转换为优化的JPEG格式
- 创建 `compressed_for_ppt/` 文件夹存放压缩后的图片
- 确保压缩后的图片总大小适合生成小于20MB的PPT

### 第三步：创建PPT

```bash
python create_ppt.py
```

### 第四步：选择处理模式

运行脚本后，会提示您选择处理模式：

- **模式1（推荐）**：使用压缩图片
  - 文件大小小于20MB
  - 适合有文件大小限制的场合
  - 使用第二步生成的压缩图片

- **模式2**：使用原始图片
  - 保持原始图片质量
  - 文件可能较大
  - 适合对图片质量要求极高的场合

## 文件结构

```
项目文件夹/
├── compress_images.py         # 图片压缩脚本
├── create_ppt.py              # PPT创建脚本
├── 副本副本灵枢智镜省赛最终_1.png    # 原始PNG图片
├── 副本副本灵枢智镜省赛最终_2.png
├── ...
├── compressed_for_ppt/        # 压缩图片文件夹（自动生成）
│   ├── 副本副本灵枢智镜省赛最终_1_optimized.jpg
│   ├── 副本副本灵枢智镜省赛最终_2_optimized.jpg
│   └── ...
└── README.md                  # 项目说明文档
```

## 输出文件

- **压缩版本**：`灵枢智镜省赛图片集_压缩版.pptx`
- **原始版本**：`灵枢智镜省赛图片集_原始比例.pptx`

## 注意事项

1. **必须先压缩**：推荐先运行 `compress_images.py` 压缩图片，再运行 `create_ppt.py`
2. **文件命名**：确保图片文件命名包含数字，脚本会根据数字排序
3. **图片格式**：原始图片为PNG格式，压缩图片为JPG格式
4. **文件大小**：压缩脚本会智能调整每张图片大小，确保最终PPT小于20MB
5. **图片比例**：脚本会自动检测图片比例并设置相应的幻灯片尺寸

## 常见问题

**Q: 为什么选择模式1时提示"未找到压缩文件夹"？**  
A: 需要先运行 `python compress_images.py` 压缩图片。

**Q: 图片显示顺序不正确怎么办？**  
A: 检查文件名中的数字是否连续且正确，脚本根据数字排序。

**Q: 生成的PPT文件过大怎么办？**  
A: 压缩脚本会自动控制大小，如果还是过大，可以修改 `compress_images.py` 中的 `target_ppt_size_mb` 参数。

**Q: 压缩后图片质量如何？**  
A: 使用智能二分查找算法，在保证文件大小的前提下尽可能保持图片质量。

## 技术实现

- 使用`python-pptx`库创建PowerPoint文件
- 使用`PIL`库处理图片信息和压缩
- 支持HEIF格式图片处理
- 智能二分查找算法优化压缩质量
- 自动检测图片比例并设置幻灯片尺寸
- 支持自定义文件排序和批量处理

## 贡献

欢迎提交Issue和Pull Request来改进这个工具！

---

💡 **提示**：建议在正式使用前先用少量图片测试，确保输出效果符合预期。 