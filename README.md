# PPT图片压缩工具

## 项目简介

这是一个专门为比赛（如大学生创新创业大赛）和学术工作设计的PPT制作工具。在许多比赛和学术场合中，经常需要提交纯图片格式的PPT，但手动一张一张保存图片既费时又难以控制文件大小在20MB以内。本工具可以自动将WPS导出的PNG图片批量转换为PPT格式，并提供压缩功能确保文件大小符合要求。

## 功能特点

- 🚀 **批量处理**：自动处理多张图片，无需手动逐张操作
- 📏 **智能适配**：自动检测图片比例，设置合适的幻灯片尺寸
- 🗜️ **智能压缩**：使用先进压缩算法，自动调整质量确保PPT文件小于20MB
- 📋 **自动排序**：根据文件名中的数字自动排序，保持正确顺序
- 🎯 **两种模式**：支持压缩版本和原始版本，满足不同需求
- 🔧 **二分查找优化**：智能寻找最佳压缩质量，平衡文件大小和图像质量
- 🎨 **用户友好**：交互式配置界面，支持自定义文件名和参数

## 使用场景

- 大学生创新创业大赛PPT制作
- 学术会议演示文稿
- 课程作业和项目汇报
- 任何需要纯图片PPT且有文件大小限制的场合

## 安装依赖

```bash
pip install python-pptx pillow pillow-heif
```

## 使用方法

### 第一步：准备图片文件

1. 在WPS中制作好您的PPT
2. 将PPT导出为PNG图片格式
3. 确保图片文件命名包含数字用于排序，例如：
   - `slide_1.png`、`slide_2.png`、`slide_3.png`...
   - `presentation_01.png`、`presentation_02.png`...
   - `page_1.jpg`、`page_2.jpg`...
   - 或任何包含数字的命名方式

### 第二步：运行图片压缩工具

```bash
python compress_images.py
```

运行后会启动配置向导，您需要输入：
- **文件名模式**：如 `slide_*.png` 或 `*.jpg`（使用 * 作为通配符）
- **目标PPT大小**：如 `18`（推荐小于20MB）
- **输出文件名前缀**：如 `我的演示文稿` 或 `项目汇报`

### 第三步：创建PPT文件

```bash
python create_ppt.py
```

运行后会启动PPT创建向导，您可以：
- 输入PPT文件名称
- 选择使用压缩图片（推荐）或原始图片

## 配置示例

### 示例1：标准命名
```
文件名模式: slide_*.png
目标大小: 18 MB
输出前缀: 我的演示文稿
```

### 示例2：数字编号
```
文件名模式: *.jpg
目标大小: 15 MB
输出前缀: 项目汇报
```

### 示例3：带前缀命名
```
文件名模式: presentation_*.png
目标大小: 20 MB
输出前缀: 学术报告
```

## 文件结构

```
项目文件夹/
├── compress_images.py         # 图片压缩脚本
├── create_ppt.py              # PPT创建脚本
├── slide_1.png                # 原始图片文件
├── slide_2.png                # （示例命名）
├── slide_3.png
├── ...
├── compressed_for_ppt/        # 压缩图片文件夹（自动生成）
│   ├── slide_1_optimized.jpg
│   ├── slide_2_optimized.jpg
│   └── ...
└── README.md                  # 项目说明文档
```

## 输出文件

- **压缩版本**：`[您的文件名]_压缩版.pptx`
- **原始版本**：`[您的文件名]_原始版.pptx`

## 注意事项

1. **必须先压缩**：推荐先运行 `compress_images.py` 压缩图片，再运行 `create_ppt.py`
2. **文件命名**：确保图片文件命名包含数字，工具会根据数字排序
3. **文件格式**：支持PNG、JPG等常见图片格式
4. **文件大小**：压缩脚本会智能调整每张图片大小，确保最终PPT小于指定大小
5. **图片比例**：脚本会自动检测图片比例并设置相应的幻灯片尺寸

## 常见问题

**Q: 如何确定正确的文件名模式？**  
A: 查看您的图片文件命名，使用 `*` 替代变化的部分。例如文件名为 `slide_1.png`，模式就是 `slide_*.png`。

**Q: 为什么选择模式1时提示"未找到压缩文件夹"？**  
A: 需要先运行 `python compress_images.py` 压缩图片。

**Q: 图片显示顺序不正确怎么办？**  
A: 检查文件名中的数字是否连续且正确，脚本根据数字排序。

**Q: 如何调整压缩质量？**  
A: 可以在压缩时设置更小的目标大小，工具会自动调整压缩质量。

**Q: 支持哪些图片格式？**  
A: 支持PNG、JPG、JPEG、BMP等常见格式，压缩后统一转换为JPG格式。

## 使用技巧

1. **文件命名建议**：使用数字编号确保正确排序，如 `01.png`、`02.png`
2. **大小控制**：如果要求更严格的大小限制，可以设置更小的目标值
3. **质量平衡**：工具会自动在文件大小和图片质量间找到最佳平衡点
4. **批量处理**：可以一次性处理大量图片，无需逐个操作

## 技术实现

- 使用`python-pptx`库创建PowerPoint文件
- 使用`PIL`库处理图片信息和压缩
- 支持HEIF格式图片处理
- 智能二分查找算法优化压缩质量
- 自动检测图片比例并设置幻灯片尺寸
- 支持自定义文件排序和批量处理

## 贡献

欢迎提交Issue和Pull Request来改进这个工具！

---

💡 **提示**：建议在正式使用前先用少量图片测试，确保输出效果符合预期。 